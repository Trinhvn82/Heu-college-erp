{% extends "layouts/renter_base.html" %}
{% load static %}
{% load humanize %}

{% block title %}Dashboard Khách thuê - {{ renter.hoten }}{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item active">Dashboard Khách thuê</li>
{% endblock %}

{% block extra_css %}
<style>
    .info-card {
        border-radius: 15px;
        border: none;
        box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        transition: all 0.3s ease;
        height: 100%;
    }
    
    .info-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.12);
    }
    
    .stat-icon {
        width: 50px;
        height: 50px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
    }
    
    .icon-primary {
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
        color: #667eea;
    }
    
    .icon-success {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.1) 100%);
        color: #10b981;
    }
    
    .icon-warning {
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.1) 0%, rgba(245, 158, 11, 0.1) 100%);
        color: #fbbf24;
    }
    
    .icon-danger {
        background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.1) 100%);
        color: #ef4444;
    }
    
    .icon-info {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.1) 100%);
        color: #3b82f6;
    }
    
    .stat-number {
        font-size: 1.5rem;
        font-weight: 700;
        color: #2d3748;
        line-height: 1.2;
    }
    
    .stat-label {
        color: #718096;
        font-size: 0.8rem;
        font-weight: 500;
        line-height: 1.3;
    }
    
    .contract-card {
        border-left: 4px solid #667eea;
        transition: all 0.3s ease;
    }
    
    .contract-card:hover {
        border-left-color: #764ba2;
        background: #f7fafc;
    }
    
    .contract-active {
        border-left-color: #10b981;
    }
    
    .contract-inactive {
        border-left-color: #9ca3af;
    }
    
    .bill-row {
        transition: all 0.3s ease;
    }
    
    .bill-row:hover {
        background: #f7fafc;
        transform: translateX(5px);
    }
    
    .badge-status {
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.75rem;
    }
    
    .welcome-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    }
    
    /* Use a unique class to avoid conflict with global .section-header in volt.css */
    .r-section-header {
        margin-bottom: 0.5rem;
        padding-bottom: 0.25rem;
        border-bottom: 2px solid #e2e8f0;
    }
    
    .r-section-header h3 {
        font-size: 1.1rem;
        font-weight: 700;
        color: #2d3748;
        margin-bottom: 0;
    }
    
    .empty-state {
        text-align: center;
        padding: 3rem 1rem;
        color: #718096;
    }
    
    .empty-state i {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.3;
    }
</style>
{% endblock %}

{% block content %}
<!-- Welcome Header -->
<div class="welcome-header mb-3">
    <div class="row align-items-center">
        <div class="col-md-8">
            <h2 class="mb-2">
                <span class="fas fa-user-circle me-2"></span>
                Xin chào, {{ renter.hoten }}!
            </h2>
            <p class="mb-0 opacity-75">
                Chào mừng bạn đến với trang quản lý hợp đồng và hóa đơn
            </p>
        </div>
        <div class="col-md-4 text-md-end mt-3 mt-md-0">
            <div class="text-white">
                <div><small>Khách thuê</small></div>
                <div class="h5 mb-0">{{ renter.hoten }}</div>
            </div>
        </div>
    </div>
</div>

<!-- Debt Alert -->
{% if total_debt > 0 %}
<div class="alert alert-warning mb-4" role="alert" style="background-color: #fff3cd; border-color: #ffc107;">
    <div class="d-flex align-items-center">
        <i class="fas fa-exclamation-triangle fa-2x me-3 text-warning"></i>
        <div style="color: #856404;">
            <h5 class="mb-1" style="color: #856404; font-weight: 700;">Thông báo công nợ</h5>
            <p class="mb-0" style="color: #856404; font-size: 1rem;">
                Bạn đang có <strong style="color: #dc3545; font-size: 1.2rem;">{{ total_debt|floatformat:0|intcomma }} VNĐ</strong> công nợ chưa thanh toán. 
                Vui lòng liên hệ chủ nhà để thanh toán.
            </p>
        </div>
    </div>
</div>
{% endif %}

<!-- Statistics Cards -->
<div class="row g-3 mb-4">
    <!-- Tổng công nợ -->
    <div class="col-md-4 col-sm-6">
        <div class="info-card card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="stat-icon icon-danger me-3">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div>
                        <div class="stat-number">{{ total_debt|floatformat:0|intcomma }}</div>
                        <div class="stat-label">Tổng công nợ (VNĐ)</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tổng số hóa đơn -->
    <div class="col-md-4 col-sm-6">
        <div class="info-card card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="stat-icon icon-info me-3">
                        <i class="fas fa-file-invoice"></i>
                    </div>
                    <div>
                        <div class="stat-number">{{ bill_stats.total }}</div>
                        <div class="stat-label">Tổng số hóa đơn</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Đã thanh toán -->
    <div class="col-md-4 col-sm-6">
        <div class="info-card card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="stat-icon icon-success me-3">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div>
                        <div class="stat-number">{{ bill_stats.paid }}</div>
                        <div class="stat-label">Đã thanh toán</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Đang thanh toán -->
    <div class="col-md-4 col-sm-6">
        <div class="info-card card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="stat-icon icon-warning me-3">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div>
                        <div class="stat-number">{{ bill_stats.paying }}</div>
                        <div class="stat-label">Đang thanh toán</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Chưa thanh toán -->
    <div class="col-md-4 col-sm-6">
        <div class="info-card card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="stat-icon icon-danger me-3">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <div>
                        <div class="stat-number">{{ bill_stats.unpaid }}</div>
                        <div class="stat-label">Chưa thanh toán</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quá hạn -->
    <div class="col-md-4 col-sm-6">
        <div class="info-card card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="stat-icon icon-danger me-3">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div>
                        <div class="stat-number">{{ bill_stats.overdue }}</div>
                        <div class="stat-label">Quá hạn</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Access Links -->
<div class="row g-3">
    <div class="col-md-3 col-sm-6">
        <a href="{% url 'renter_contracts' %}" class="text-decoration-none">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body text-center py-4">
                    <div class="mb-3">
                        <i class="fas fa-file-contract fa-3x text-primary"></i>
                    </div>
                    <h5 class="mb-2">Hợp đồng</h5>
                    <p class="text-muted small mb-0">Xem chi tiết các hợp đồng thuê</p>
                </div>
            </div>
        </a>
    </div>
    
    <div class="col-md-3 col-sm-6">
        <a href="{% url 'renter_bills' %}" class="text-decoration-none">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body text-center py-4">
                    <div class="mb-3">
                        <i class="fas fa-file-invoice-dollar fa-3x text-success"></i>
                    </div>
                    <h5 class="mb-2">Hóa đơn</h5>
                    <p class="text-muted small mb-0">Xem và thanh toán hóa đơn</p>
                </div>
            </div>
        </a>
    </div>
    
    <div class="col-md-3 col-sm-6">
        <a href="{% url 'renter_locations' %}" class="text-decoration-none">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body text-center py-4">
                    <div class="mb-3">
                        <i class="fas fa-map-marked-alt fa-3x text-info"></i>
                    </div>
                    <h5 class="mb-2">Địa điểm</h5>
                    <p class="text-muted small mb-0">Xem thông tin địa điểm thuê</p>
                </div>
            </div>
        </a>
    </div>
    
    <div class="col-md-3 col-sm-6">
        <a href="{% url 'renter_issues' %}" class="text-decoration-none">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body text-center py-4">
                    <div class="mb-3">
                        <i class="fas fa-triangle-exclamation fa-3x text-warning"></i>
                    </div>
                    <h5 class="mb-2">Sự cố</h5>
                    <p class="text-muted small mb-0">Báo cáo và theo dõi sự cố</p>
                </div>
            </div>
        </a>
    </div>
</div>

<!-- Contact Info removed per request -->
{% endblock %}
